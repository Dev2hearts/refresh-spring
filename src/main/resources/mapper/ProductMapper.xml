<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.green.refresh.product.PdtMapper">
    <insert id="insPdt">
        INSERT INTO t_product
        SET iplan = #{iplan}
        , icate = #{icate}
        , iunit = #{iunit}
        , w_iuser = #{wIuser}
        , nm = #{nm}
        , cnt = #{cnt}
    </insert>

    <select id="selPdt" resultType="PdtSelVo">
        SELECT A.icate, A.iunit, A.w_iuser wIuser, A.nm, A.cnt, A.del_yn delYn
        FROM t_product A
        JOIN t_plan B
        ON A.iplan = B.iplan
        WHERE igroup = #{igroup}
        AND created_at = #{createdAt}
    </select>

    <update id="updPdt">
        UPDATE t_product
        SET nm = #{nm}
        , icate = #{icate}
        , cnt = #{cnt}
        , iunit = #{iunit}
        WHERE iproduct = #{iproduct}
    </update>

    <update id="delPdt">
        <selectKey keyProperty="delYn" resultType="PdtEntity" order="AFTER">
            SELECT del_yn delYn FROM t_product WHERE iproduct = #{iproduct}
        </selectKey>
        UPDATE t_product
        SET del_yn = 1 - del_yn
        WHERE iproduct = #{iproduct}

    </update>



</mapper>